(function(t){function e(e){for(var o,s,n=e[0],l=e[1],c=e[2],m=0,u=[];m<n.length;m++)s=n[m],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&u.push(i[s][0]),i[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);d&&d(e);while(u.length)u.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],o=!0,n=1;n<a.length;n++){var l=a[n];0!==i[l]&&(o=!1)}o&&(r.splice(e--,1),t=s(s.s=a[0]))}return t}var o={},i={app:0},r=[];function s(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=o,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(a,o,function(e){return t[e]}.bind(null,o));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var d=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("e9f5"),a("910d");var o=a("2b0e"),i=a("7496"),r=a("40dc"),s=a("5bc1"),n=a("8336"),l=a("b0af"),c=a("99d9"),d=a("03a4"),m=a("169a"),u=a("132d"),h=a("8860"),p=a("da13"),f=a("1800"),v=a("5d23"),g=a("1baa"),_=a("f6c4"),b=a("e449"),y=a("f774"),$=a("2fa4"),k=a("8654"),w=a("2a7f"),x=a("3a2f"),C=(a("14d9"),function(){var t=this,e=t._self._c;return e(i["a"],[e(y["a"],{attrs:{temporary:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[e(h["a"],[e(p["a"],{attrs:{link:"",href:"#/?room="+t.$root.room}},[e(f["a"],[e(u["a"],[t._v(t._s(t.mdiContentPaste))])],1),e(v["a"],[e(v["c"],[t._v("剪贴板")])],1)],1),e(p["a"],{attrs:{link:"",href:"#/device"}},[e(f["a"],[e(u["a"],[t._v(t._s(t.mdiDevices))])],1),e(v["a"],[e(v["c"],[t._v("设备列表")])],1)],1),e(b["a"],{attrs:{"offset-x":"",transition:"slide-x-transition","open-on-click":"","open-on-hover":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(p["a"],t._g({attrs:{link:""}},a),[e(f["a"],[e(u["a"],[t._v(t._s(t.mdiBrightness4))])],1),e(v["a"],[e(v["c"],[t._v("深色模式")])],1)],1)]}}])},[e(h["a"],{attrs:{"two-line":""}},[e(g["a"],{attrs:{color:"primary",mandatory:""},model:{value:t.$root.dark,callback:function(e){t.$set(t.$root,"dark",e)},expression:"$root.dark"}},[e(p["a"],{attrs:{link:"",value:"time"}},[e(v["a"],[e(v["c"],[t._v("根据时间切换")]),e(v["b"],[t._v("在 19:00 到次日 7:00 期间启用")])],1)],1),e(p["a"],{attrs:{link:"",value:"prefer"}},[e(v["a"],[e(v["c"],[t._v("根据系统设置切换")]),e(v["b"],[t._v("使用 "),e("code",[t._v("prefers-color-scheme")]),t._v(" 检测")])],1)],1),e(p["a"],{attrs:{link:"",value:"enable"}},[e(v["a"],[e(v["c"],[t._v("保持启用")])],1)],1),e(p["a"],{attrs:{link:"",value:"disable"}},[e(v["a"],[e(v["c"],[t._v("保持禁用")])],1)],1)],1)],1)],1),e(p["a"],{attrs:{link:""},on:{click:function(e){t.colorDialog=!0,t.drawer=!1}}},[e(f["a"],[e(u["a"],[t._v(t._s(t.mdiPalette))])],1),e(v["a"],[e(v["c"],[t._v("更改主题色")])],1)],1),e(p["a"],{attrs:{link:"",href:"#/about"}},[e(f["a"],[e(u["a"],[t._v(t._s(t.mdiInformation))])],1),e(v["a"],[e(v["c"],[t._v("关于")])],1)],1)],1)],1),e(r["a"],{attrs:{app:"",color:"primary",dark:""}},[e(s["a"],{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),e(w["a"],[t._v("云剪贴板"),t.$root.room?e("span",{staticClass:"d-none d-sm-inline"},[t._v("（房间："),e("abbr",{staticStyle:{cursor:"pointer"},attrs:{title:"点击复制"},on:{click:function(e){t.navigator.clipboard.writeText(t.$root.room).then(()=>t.$toast("已复制房间名称："+t.$root.room).catch(e=>t.$toast.error("复制失败："+e)))}}},[t._v(t._s(t.$root.room))]),t._v("）")]):t._e()]),e($["a"]),e(x["a"],{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:""},on:{click:function(e){t.clearAllDialog=!0}}},a),[e(u["a"],[t._v(t._s(t.mdiNotificationClearAll))])],1)]}}])},[e("span",[t._v("清空剪贴板")])]),e(x["a"],{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:""},on:{click:function(e){t.$root.roomInput=t.$root.room,t.$root.roomDialog=!0}}},a),[e(u["a"],[t._v(t._s(t.mdiBulletinBoard))])],1)]}}])},[e("span",[t._v("进入房间")])]),e(x["a"],{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:""},on:{click:function(e){t.$root.websocket||t.$root.websocketConnecting||(t.$root.retry=0,t.$root.connect())}}},a),[t.$root.websocket?e(u["a"],[t._v(t._s(t.mdiLanConnect))]):t.$root.websocketConnecting?e(u["a"],[t._v(t._s(t.mdiLanPending))]):e(u["a"],[t._v(t._s(t.mdiLanDisconnect))])],1)]}}])},[t.$root.websocket?e("span",[t._v("已连接")]):t.$root.websocketConnecting?e("span",[t._v("连接中")]):e("span",[t._v("未连接，点击重连")])])],1),e(_["a"],[t.$route.meta.keepAlive?[e("keep-alive",[e("router-view")],1)]:e("router-view")],2),e(m["a"],{attrs:{"max-width":"300","hide-overlay":""},model:{value:t.colorDialog,callback:function(e){t.colorDialog=e},expression:"colorDialog"}},[e(l["a"],[e(c["c"],[t._v("选择主题颜色")]),e(c["b"],[t.$vuetify.theme.dark?e(d["a"],{attrs:{"show-swatches":"","hide-inputs":""},model:{value:t.$vuetify.theme.themes.dark.primary,callback:function(e){t.$set(t.$vuetify.theme.themes.dark,"primary",e)},expression:"$vuetify.theme.themes.dark.primary "}}):e(d["a"],{attrs:{"show-swatches":"","hide-inputs":""},model:{value:t.$vuetify.theme.themes.light.primary,callback:function(e){t.$set(t.$vuetify.theme.themes.light,"primary",e)},expression:"$vuetify.theme.themes.light.primary"}})],1),e(c["a"],[e($["a"]),e(n["a"],{attrs:{color:"primary",text:""},on:{click:function(e){t.colorDialog=!1}}},[t._v("确定")])],1)],1)],1),e(m["a"],{attrs:{persistent:"","max-width":"360"},model:{value:t.$root.authCodeDialog,callback:function(e){t.$set(t.$root,"authCodeDialog",e)},expression:"$root.authCodeDialog"}},[e(l["a"],[e(c["c"],{staticClass:"headline"},[t._v("需要认证")]),e(c["b"],[e("p",[t._v("这个剪贴板服务并不是公开的，请输入密码以继续连接。")]),e(k["a"],{attrs:{label:"密码"},model:{value:t.$root.authCode,callback:function(e){t.$set(t.$root,"authCode",e)},expression:"$root.authCode"}})],1),e(c["a"],[e($["a"]),e(n["a"],{attrs:{color:"primary darken-1",text:""},on:{click:function(e){t.$root.authCodeDialog=!1,t.$root.connect()}}},[t._v("提交")])],1)],1)],1),e(m["a"],{attrs:{persistent:"","max-width":"360"},model:{value:t.$root.roomDialog,callback:function(e){t.$set(t.$root,"roomDialog",e)},expression:"$root.roomDialog"}},[e(l["a"],[e(c["c"],{staticClass:"headline"},[t._v("剪贴板房间")]),e(c["b"],[e("p",[t._v("输入任意名称创建新房间，或进入已有的房间。留空则表示使用默认的全局房间。")]),e("p",[t._v("在房间中发送的内容仅限房间内可见，保存的历史记录数量仍然会受到全局设定的限制。")]),e(k["a"],{attrs:{label:"房间名称","append-icon":t.mdiDiceMultiple},on:{"click:append":function(e){t.$root.roomInput=["reimu","marisa","rumia","cirno","meiling","patchouli","sakuya","remilia","flandre","letty","chen","lyrica","lunasa","merlin","youmu","yuyuko","ran","yukari","suika","mystia","keine","tewi","reisen","eirin","kaguya","mokou"][Math.floor(26*Math.random())]+"-"+Math.random().toString(16).substring(2,6)}},model:{value:t.$root.roomInput,callback:function(e){t.$set(t.$root,"roomInput",e)},expression:"$root.roomInput"}})],1),e(c["a"],[e($["a"]),e(n["a"],{attrs:{color:"primary darken-1",text:""},on:{click:function(e){t.$root.roomDialog=!1}}},[t._v("取消")]),e(n["a"],{attrs:{color:"primary darken-1",text:""},on:{click:function(e){t.$router.push({path:"/",query:{room:t.$root.roomInput}}),t.$root.roomDialog=!1}}},[t._v("进入房间")])],1)],1)],1),e(m["a"],{attrs:{"max-width":"360"},model:{value:t.clearAllDialog,callback:function(e){t.clearAllDialog=e},expression:"clearAllDialog"}},[e(l["a"],[e(c["c"],{staticClass:"headline"},[t._v("清空剪贴板")]),e(c["b"],[e("p",[t._v("是否要清空当前房间的所有剪贴板内容？")])]),e(c["a"],[e($["a"]),e(n["a"],{attrs:{color:"primary darken-1",text:""},on:{click:function(e){t.clearAllDialog=!1}}},[t._v("取消")]),e(n["a"],{attrs:{color:"primary darken-1",text:""},on:{click:function(e){t.clearAllDialog=!1,t.clearAll()}}},[t._v("确定")])],1)],1)],1)],1)}),S=[],P=a("94ed"),D={data(){return{drawer:!1,colorDialog:!1,clearAllDialog:!1,mdiContentPaste:P["j"],mdiDevices:P["k"],mdiInformation:P["q"],mdiLanConnect:P["r"],mdiLanDisconnect:P["s"],mdiLanPending:P["t"],mdiBrightness4:P["d"],mdiBulletinBoard:P["e"],mdiDiceMultiple:P["l"],mdiPalette:P["z"],mdiNotificationClearAll:P["y"],navigator:navigator}},methods:{async clearAll(){try{const t=this.$root.received.filter(t=>"file"===t.type);await this.$http.delete("revoke/all",{params:{room:this.$root.room}});for(const e of t)await this.$http.delete("file/"+e.cache);this.$toast.success("剪贴板已清空"),this.$root.received&&(this.$root.received=[]),this.$root.$emit("clipboard-cleared")}catch(t){console.log(t),t.response&&t.response.data.msg?this.$toast("清空剪贴板失败："+t.response.data.msg):this.$toast("清空剪贴板失败")}}},mounted(){const t=localStorage.getItem("darkPrimary"),e=localStorage.getItem("lightPrimary");t&&(this.$vuetify.theme.themes.dark.primary=t),e&&(this.$vuetify.theme.themes.light.primary=e),this.$watch("$vuetify.theme.themes.dark.primary",t=>{localStorage.setItem("darkPrimary",t)}),this.$watch("$vuetify.theme.themes.light.primary",t=>{localStorage.setItem("lightPrimary",t)})}},A=D,O=(a("9067"),a("2877")),T=Object(O["a"])(A,C,S,!1,null,"34584114",null),I=T.exports,L=a("8c4f"),z=a("62ad"),M=a("a523"),j=a("ce7e"),F=a("0789"),U=a("0fd9"),R=a("c73b"),B=a("71d9"),V=function(){var t=this,e=t._self._c;return e(M["a"],[e(U["a"],[e(z["a"],{staticClass:"hidden-sm-and-down",attrs:{cols:"12",md:"4"}},[e("send-text"),e(j["a"],{staticClass:"my-4"}),e("send-file")],1),e(z["a"],{attrs:{cols:"12",md:"8"}},[e(F["b"],{attrs:{group:""}},t._l(t.$root.received,(function(t){return e("received-"+t.type,{key:t.id,tag:"div",attrs:{meta:t}})})),1),e("div",{staticClass:"text-center caption text--secondary py-2"},[t._v(t._s(t.$root.received.length?"已经到底了哦～":"这里空空的"))])],1)],1),e(R["a"],{staticClass:"hidden-md-and-up",staticStyle:{transform:"translateY(-64px)"},attrs:{bottom:"",right:"",fixed:"",direction:"top",transition:"scale-transition"},scopedSlots:t._u([{key:"activator",fn:function(){return[e(n["a"],{attrs:{fab:"",dark:"",color:"primary"},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[e(u["a"],[t._v(t._s(t.mdiPlus))])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[e(n["a"],{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){t.dialog=!0,t.mode="file",t.setTimeout(()=>t.$refs.dialogFile.focus(),300)}}},[e(u["a"],[t._v(t._s(t.mdiFileDocumentOutline))])],1),e(n["a"],{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){t.dialog=!0,t.mode="text",t.setTimeout(()=>t.$refs.dialogText.focus(),300)}}},[e(u["a"],[t._v(t._s(t.mdiText))])],1)],1),e(m["a"],{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition",scrollable:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e(l["a"],[e(B["a"],{staticClass:"flex-grow-0",attrs:{dark:"",color:"primary"}},[e(n["a"],{attrs:{icon:""},on:{click:function(e){t.dialog=!1}}},[e(u["a"],[t._v(t._s(t.mdiClose))])],1),"text"===t.mode?e(w["a"],[t._v("发送文本")]):t._e(),"file"===t.mode?e(w["a"],[t._v("发送文件")]):t._e(),e($["a"])],1),e(c["b"],{staticClass:"px-4"},[e("div",{staticClass:"my-4"},["text"===t.mode?e("send-text",{ref:"dialogText"}):t._e(),"file"===t.mode?e("send-file",{ref:"dialogFile"}):t._e()],1)])],1)],1)],1)},N=[],q=a("a844"),E=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"headline text--primary mb-4"},[t._v("发送文本")]),e(q["a"],{ref:"textarea",attrs:{"no-resize":"",outlined:"",dense:"",rows:"6",counter:t.$root.config.text.limit,placeholder:"请输入需要发送的文本"},model:{value:t.$root.send.text,callback:function(e){t.$set(t.$root.send,"text",e)},expression:"$root.send.text"}}),e("div",{staticClass:"text-right"},[e(n["a"],{attrs:{color:"primary",block:t.$vuetify.breakpoint.smAndDown,disabled:!t.$root.send.text||!t.$root.websocket||t.$root.send.text.length>t.$root.config.text.limit},on:{click:t.send}},[t._v("发送")])],1)],1)},W=[],H=(a("88a7"),a("271a"),a("5494"),{name:"send-text",methods:{focus(){this.$refs.textarea.focus()},send(){this.$http.post("text",this.$root.send.text,{params:new URLSearchParams([["room",this.$root.room]]),headers:{"Content-Type":"text/plain"}}).then(t=>{this.$toast("发送成功"),this.$root.send.text=""}).catch(t=>{t.response&&t.response.data.msg?this.$toast("发送失败："+t.response.data.msg):this.$toast("发送失败")})}}}),J=H,G=Object(O["a"])(J,E,W,!1,null,null,null),Y=G.exports,K=a("adda"),Q=a("8e36"),X=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"headline text--primary mb-4"},[t._v("发送文件")]),e(l["a"],{staticClass:"pa-3 mb-6 d-flex flex-row align-center",attrs:{outlined:""},on:{dragenter:function(t){return t.preventDefault()},dragover:function(t){return t.preventDefault()},dragleave:function(t){return t.preventDefault()},drop:function(e){e.preventDefault(),t.handleSelectFiles(Array.from(e.dataTransfer.files))}}},[t.$root.send.files.length?[t.progress?[e("div",{staticClass:"flex-grow-1"},[e("small",{staticClass:"d-block text-right text--secondary"},[t._v(" "+t._s(t._f("prettyFileSize")(Math.min(t.uploadedSize,t.fileSize)))+" / "+t._s(t._f("prettyFileSize")(t.fileSize))+" ("+t._s(t._f("percentage")(t.uploadProgress))+") ")]),e(Q["a"],{attrs:{value:100*t.uploadProgress}})],1)]:[t.isUploadingImage?e(K["a"],{staticClass:"mr-3 flex-grow-0",staticStyle:{"border-radius":"3px"},attrs:{src:t.imagePreview,width:"2.5rem",height:"2.5rem"}}):t._e(),e("div",{staticClass:"flex-grow-1 mr-2",staticStyle:{"min-width":"0"}},[e("div",{staticClass:"text-truncate",attrs:{title:t.$root.send.files[0].name+" "+(t.$root.send.files.length>1?`等 ${t.$root.send.files.length} 个文件`:"")}},[t._v(t._s(t.$root.send.files[0].name)+" "+t._s(t.$root.send.files.length>1?`等 ${t.$root.send.files.length} 个文件`:"")+" ")]),e("div",{staticClass:"caption"},[t._v(t._s(t._f("prettyFileSize")(t.fileSize)))])]),e("div",{staticClass:"align-self-center"},[e(n["a"],{attrs:{icon:"",color:"grey"},on:{click:function(e){return t.$root.send.files.splice(0)}}},[e(u["a"],[t._v(t._s(t.mdiClose))])],1)],1)]]:[e(n["a"],{staticClass:"d-block mx-auto",attrs:{text:"",color:"primary",large:""},on:{click:t.focus}},[e("div",{attrs:{title:"支持拖拽和 Ctrl+V 粘贴截图"}},[t._v(" 选择要发送的文件"),e("span",{staticClass:"d-none d-xl-inline"},[t._v("（支持拖拽和 Ctrl+V 粘贴截图）")]),e("br"),e("small",{staticClass:"text--secondary"},[t._v("文件大小限制："+t._s(t._f("prettyFileSize")(t.$root.config.file.limit)))])])]),e("input",{ref:"selectFile",staticClass:"d-none",attrs:{type:"file",multiple:""},on:{change:function(e){t.handleSelectFiles(Array.from(e.target.files))}}})]],2),e("div",{staticClass:"text-right"},[e(n["a"],{attrs:{color:"primary",block:t.$vuetify.breakpoint.smAndDown,disabled:!t.$root.send.files.length||!t.$root.websocket||t.progress},on:{click:t.send}},[t._v("发送")])],1)],1)},Z=[];a("13d5"),a("d866"),a("ab43"),a("9485"),a("a732");function tt(t){let e=["TB","GB","MB","KB"],a="Bytes";while(t>=1024&&e.length)t/=1024,a=e.pop();return`${Math.floor(100*t)/100} ${a}`}function et(t,e=2){return(100*t).toFixed(e)+"%"}function at(t){let e=new Date(1e3*t);return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,0)+"-"+e.getDate().toString().padStart(2,0)+" "+e.getHours().toString().padStart(2,0)+":"+e.getMinutes().toString().padStart(2,0)+":"+e.getSeconds().toString().padStart(2,0)}var ot={name:"send-file",data(){return{progress:!1,uploadedSizes:[],imagePreview:"",uploading:!1,mdiClose:P["h"]}},computed:{fileSize(){return this.$root.send.files.length?this.$root.send.files.reduce((t,e)=>t+e.size,0):0},uploadedSize(){return this.uploadedSizes.length?this.uploadedSizes.reduce((t,e)=>t+e,0):0},uploadProgress(){return Math.min(0!==this.fileSize?this.uploadedSize/this.fileSize:0,1)},isUploadingImage(){return this.$root.send.files.length&&this.$root.send.files[0].type.startsWith("image/")}},methods:{focus(){this.$refs.selectFile.click()},handleSelectFiles(t){t.some(t=>!t.size)?this.$toast("不能发送空文件"):t.some(t=>t.size>this.$root.config.file.limit)?this.$toast(`文件大小超过限制（${tt(this.$root.config.file.limit)}）`):(this.$root.send.files.splice(0),this.$root.send.files.push(...t),this.isUploadingImage&&(URL.revokeObjectURL(this.imagePreview),this.imagePreview=URL.createObjectURL(t[0])))},async send(){try{const t=this.$root.config.file.chunk;this.uploadedSizes.splice(0),this.uploadedSizes.push(...Array(this.$root.send.files.length).fill(0)),await Promise.all(this.$root.send.files.map(async(e,a)=>{let o=await this.$http.post("upload",e.name,{headers:{"Content-Type":"text/plain"}}),i=o.data.result.uuid,r=0;this.progress=!0;while(r<e.size){let o=e.slice(r,r+t);await this.$http.post("upload/chunk/"+i,o,{headers:{"Content-Type":"application/octet-stream"},onUploadProgress:t=>this.$set(this.uploadedSizes,a,r+t.loaded)}),r+=t}await this.$http.post("upload/finish/"+i,null,{params:new URLSearchParams([["room",this.$root.room]])})})),this.$toast("发送成功"),this.$root.send.files.splice(0)}catch(t){t.response&&t.response.data.msg?this.$toast("发送失败："+t.response.data.msg):this.$toast("发送失败")}finally{this.progress=!1}}},mounted(){document.onpaste=t=>{if(!t||!t.clipboardData)return;console.log(t.clipboardData);const e=Array.from(t.clipboardData.items);e.length&&e.every(t=>"file"===t.kind)&&this.handleSelectFiles(e.map(t=>t.getAsFile()))}}},it=ot,rt=Object(O["a"])(it,X,Z,!1,null,null,null),st=rt.exports,nt=a("ce87"),lt=function(){var t=this,e=t._self._c;return e(nt["a"],{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return[e(l["a"],{staticClass:"mb-2 transition-swing",attrs:{elevation:a?6:2}},[e(c["b"],[e("div",{staticClass:"d-flex flex-row align-center"},[e("div",{staticClass:"flex-grow-1 mr-2",staticStyle:{"min-width":"0"}},[e("div",{staticClass:"title text-truncate text--primary",on:{click:function(e){t.expand=!t.expand}}},[t._v(" 文本消息"),e(u["a"],[t._v(t._s(t.expand?t.mdiChevronUp:t.mdiChevronDown))])],1),e("div",{directives:[{name:"linkified",rawName:"v-linkified"}],staticClass:"text-truncate",domProps:{innerHTML:t._s(t.meta.content.trim())},on:{click:function(e){t.expand=!t.expand}}})]),e("div",{staticClass:"align-self-center text-no-wrap"},[e(x["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey"},on:{click:t.copyText}},a),[e(u["a"],[t._v(t._s(t.mdiContentCopy))])],1)]}}],null,!0)},[e("span",[t._v("复制")])]),e(x["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey"},on:{click:t.deleteItem}},a),[e(u["a"],[t._v(t._s(t.mdiClose))])],1)]}}],null,!0)},[e("span",[t._v("删除")])])],1)]),e(F["a"],[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expand,expression:"expand"}]},[e(j["a"],{staticClass:"my-2"}),e("div",{directives:[{name:"linkified",rawName:"v-linkified"}],ref:"content",domProps:{innerHTML:t._s(t.meta.content.replace(/\n/g,"<br>"))}})],1)])],1)],1)]}}])})},ct=[],dt={name:"received-text",props:{meta:{type:Object,default(){return{}}}},data(){return{expand:!1,mdiChevronUp:P["g"],mdiChevronDown:P["f"],mdiContentCopy:P["i"],mdiClose:P["h"]}},methods:{copyText(){let t=document.createElement("textarea");t.value=(new DOMParser).parseFromString(this.meta.content,"text/html").documentElement.textContent,t.style.cssText="top:0;left:0;position:fixed",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t),this.$toast("复制成功")},deleteItem(){this.$http.delete("revoke/"+this.meta.id,{params:new URLSearchParams([["room",this.$root.room]])}).then(()=>{this.$toast("已删除文本消息")}).catch(t=>{t.response&&t.response.data.msg?this.$toast("消息删除失败："+t.response.data.msg):this.$toast("消息删除失败")})}}},mt=dt,ut=Object(O["a"])(mt,lt,ct,!1,null,null,null),ht=ut.exports,pt=a("490a"),ft=function(){var t=this,e=t._self._c;return e(nt["a"],{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return[e(l["a"],{staticClass:"mb-2 transition-swing",attrs:{elevation:a?6:2}},[e(c["b"],[e("div",{staticClass:"d-flex flex-row align-center"},[t.meta.thumbnail?e(K["a"],{staticClass:"mr-3 flex-grow-0 hidden-sm-and-down",staticStyle:{"border-radius":"3px"},attrs:{src:t.meta.thumbnail,width:"2.5rem",height:"2.5rem"}}):t._e(),e("div",{staticClass:"flex-grow-1 mr-2",staticStyle:{"min-width":"0"}},[e("div",{staticClass:"title text-truncate text--primary",style:{"text-decoration":t.expired?"line-through":""},attrs:{title:t.meta.name}},[t._v(t._s(t.meta.name))]),e("div",{staticClass:"caption"},[t._v(" "+t._s(t._f("prettyFileSize")(t.meta.size))+" "),t.$vuetify.breakpoint.smAndDown?[e("br")]:[t._v("|")],t._v(" "+t._s(t.expired?"已":"将")+"于 "+t._s(t._f("formatTimestamp")(t.meta.expire))+" 过期 ")],2)]),e("div",{staticClass:"align-self-center text-no-wrap"},[e(x["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey",href:t.expired?null:"file/"+t.meta.cache,download:t.expired?null:t.meta.name}},a),[e(u["a"],[t._v(t._s(t.expired?t.mdiDownloadOff:t.mdiDownload))])],1)]}}],null,!0)},[e("span",[t._v(t._s(t.expired?"已过期":"下载"))])]),t.meta.thumbnail||t.isPreviewableVideo||t.isPreviewableAudio?[t.loadingPreview?e(pt["a"],{attrs:{indeterminate:"",color:"grey"}},[t._v(t._s(t._f("percentage")(t.loadedPreview/t.meta.size,0)))]):t._e(),e(x["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey"},on:{click:function(e){!t.expired&&t.previewFile()}}},a),[e(u["a"],[t._v(t._s(t.isPreviewableVideo||t.isPreviewableAudio?t.mdiMovieSearchOutline:t.mdiImageSearchOutline))])],1)]}}],null,!0)},[e("span",[t._v("预览")])])]:t._e(),e(x["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey",disabled:t.loadingPreview},on:{click:t.deleteItem}},a),[e(u["a"],[t._v(t._s(t.mdiClose))])],1)]}}],null,!0)},[e("span",[t._v("删除")])])],2)],1),t.meta.thumbnail||t.isPreviewableVideo||t.isPreviewableAudio?e(F["a"],[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expand,expression:"expand"}]},[e(j["a"],{staticClass:"my-2"}),t.isPreviewableVideo?e("video",{staticClass:"rounded d-block mx-auto",staticStyle:{"max-height":"480px","max-width":"100%"},attrs:{src:t.srcPreview,controls:"",preload:"metadata"}}):t.isPreviewableAudio?e("audio",{staticClass:"rounded d-block mx-auto",staticStyle:{width:"100%"},attrs:{src:t.srcPreview,controls:"",preload:"metadata"}}):e("img",{staticClass:"rounded d-block mx-auto",staticStyle:{"max-height":"480px","max-width":"100%"},attrs:{src:t.srcPreview}})],1)]):t._e()],1)],1)]}}])})},vt=[],gt={name:"received-file",props:{meta:{type:Object,default(){return{}}}},data(){return{loadingPreview:!1,loadedPreview:0,expand:!1,srcPreview:null,mdiContentCopy:P["i"],mdiDownload:P["m"],mdiDownloadOff:P["n"],mdiClose:P["h"],mdiImageSearchOutline:P["p"],mdiMovieSearchOutline:P["x"]}},computed:{expired(){return this.$root.date.getTime()/1e3>this.meta.expire},isPreviewableVideo(){return this.meta.name.match(/\.(mp4|webm|ogv)$/gi)},isPreviewableAudio(){return this.meta.name.match(/\.(wav|ogg|opus|m4a|flac)$/gi)}},methods:{previewFile(){this.expand?this.expand=!1:this.srcPreview?this.expand=!0:(this.expand=!0,this.isPreviewableVideo||this.isPreviewableAudio?this.srcPreview="file/"+this.meta.cache:(this.loadingPreview=!0,this.loadedPreview=0,this.$http.get("file/"+this.meta.cache,{responseType:"arraybuffer",onDownloadProgress:t=>{this.loadedPreview=t.loaded}}).then(t=>{this.srcPreview=URL.createObjectURL(new Blob([t.data]))}).catch(t=>{t.response&&t.response.data.msg?this.$toast("文件获取失败："+t.response.data.msg):this.$toast("文件获取失败")}).finally(()=>{this.loadingPreview=!1})))},deleteItem(){this.$http.delete("revoke/"+this.meta.id,{params:new URLSearchParams([["room",this.$root.room]])}).then(()=>{this.expired||this.$http.delete("file/"+this.meta.cache).then(()=>{this.$toast("已删除文件 "+this.meta.name)}).catch(t=>{t.response&&t.response.data.msg?this.$toast("文件删除失败："+t.response.data.msg):this.$toast("文件删除失败")})}).catch(t=>{t.response&&t.response.data.msg?this.$toast("消息删除失败："+t.response.data.msg):this.$toast("消息删除失败")})}}},_t=gt,bt=Object(O["a"])(_t,ft,vt,!1,null,null,null),yt=bt.exports,$t={components:{SendText:Y,SendFile:st,ReceivedText:ht,ReceivedFile:yt},data(){return{fab:!1,dialog:!1,mode:null,mdiPlus:P["A"],mdiFileDocumentOutline:P["o"],mdiText:P["C"],mdiClose:P["h"]}},methods:{closeDialog(){this.dialog=!1},setTimeout(t,e){return setTimeout(t,e)}},watch:{dialog(t){t?(history.pushState(null,null,location.href),addEventListener("popstate",this.closeDialog)):removeEventListener("popstate",this.closeDialog)}},beforeRouteEnter(t,e,a){a(e=>e.$root.room=t.query.room||"")},beforeRouteUpdate(t,e,a){this.$root.room=t.query.room||"",a()}},kt=$t,wt=Object(O["a"])(kt,V,N,!1,null,null,null),xt=wt.exports,Ct=a("8270"),St=a("6b53"),Pt=function(){var t=this,e=t._self._c;return e(M["a"],[e(St["a"],{staticClass:"mx-auto",attrs:{"max-width":"640"}},[e("div",{staticClass:"headline text--primary my-4"},[t._v("已连接的设备列表")]),t.$root.websocket?[t._v(" 已有 "+t._s(t.$root.device.length)+" 个设备连接，桌面端设备 "+t._s(t.desktopDeviceCount)+" 个，移动端设备 "+t._s(t.mobileDeviceCount)+" 个。 "),e(j["a"],{staticClass:"my-2"})]:[t._v(" 未连接到服务器。 ")],e(h["a"],{attrs:{rounded:"","two-line":""}},[e(g["a"],{attrs:{color:"primary"}},t._l(t.$root.device,(function(a){return e(p["a"],{key:a.id},[e(Ct["a"],{attrs:{tile:""}},["desktop"===a.type?["Windows"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiMicrosoftWindows))]):"GNU/Linux"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiLinux))]):"Mac"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiApple))]):e(u["a"],[t._v(t._s(t.mdiLaptop))])]:"smartphone"===a.type||"mobile"===a.type||"tablet"===a.type?["Android"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiAndroid))]):"iOS"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiAppleIos))]):e(u["a"],[t._v(t._s(t.mdiTabletCellphone))])]:e(u["a"],[t._v(t._s(t.mdiDevices))])],2),e(v["a"],[e(v["c"],[t._v(t._s("desktop"===a.type?"桌面端设备":a.device||("smartphone"===a.type||"mobile"===a.type||"tablet"===a.type?"移动端设备":"其他类型设备")))]),e(v["b"],[t._v(t._s(a.os)+" ("+t._s(a.browser)+")")])],1)],1)})),1)],1)],2)],1)},Dt=[],At={data(){return{mdiLaptop:P["u"],mdiMicrosoftWindows:P["w"],mdiApple:P["b"],mdiLinux:P["v"],mdiTabletCellphone:P["B"],mdiAndroid:P["a"],mdiAppleIos:P["c"],mdiDevices:P["k"]}},computed:{desktopDeviceCount(){return this.$root.device.filter(t=>"desktop"===t.type).length},mobileDeviceCount(){return this.$root.device.filter(t=>"smartphone"===t.type||"tablet"===t.type).length}}},Ot=At,Tt=Object(O["a"])(Ot,Pt,Dt,!1,null,null,null),It=Tt.exports,Lt=function(){var t=this,e=t._self._c;return e(M["a"],{attrs:{"fill-height":""}},[e(U["a"],{staticClass:"pa-3",attrs:{justify:"center",align:"center"}},[e("div",{staticClass:"text-center"},[e("p",{staticClass:"headline my-4"},[t._v("Cloud Clipboard "+t._s(t.$root.config.version))]),e("p",[t._v("在局域网内互传纯文本和文件的云剪贴板"),e("br"),t._v("即开即用的网页版，无须安装 APP")]),e("p",[e("a",{attrs:{href:"https://github.com/TransparentLC/cloud-clipboard",target:"_blank"}},[e("img",{attrs:{src:"https://img.shields.io/github/stars/TransparentLC/cloud-clipboard.svg?style=social"}})])]),e("p",{staticClass:"text--secondary"},[e("small",[t._v("如果你觉得这个工具很好用，欢迎"),e("a",{attrs:{href:"https://i.akarin.dev/donate/",target:"_blank"}},[t._v("捐赠支持开发者")]),t._v("～")])])])])],1)},zt=[],Mt={},jt=Mt,Ft=Object(O["a"])(jt,Lt,zt,!1,null,null,null),Ut=Ft.exports;o["a"].use(L["a"]);const Rt=new L["a"]({routes:[{path:"/",component:xt,meta:{keepAlive:!0}},{path:"/device",component:It,meta:{keepAlive:!0}},{path:"/about",component:Ut,meta:{keepAlive:!0}}]});var Bt=Rt,Vt=a("f309"),Nt=a("2db4"),qt=a("87f6"),Et=a.n(qt);const Wt=new Vt["a"]({icons:{iconfont:"mdiSvg"}});o["a"].use(Vt["a"],{components:{VSnackbar:Nt["a"],VBtn:n["a"],VIcon:u["a"]}}),o["a"].use(Et.a,{$vuetify:Wt.framework,x:"",color:"",closeText:"关闭",closeColor:"accent"});var Ht=Wt,Jt={data(){return{websocket:null,websocketConnecting:!1,authCode:localStorage.getItem("auth")||"",authCodeDialog:!1,room:this.$router.currentRoute.query.room||"",roomInput:"",roomDialog:!1,retry:0,event:{receive:t=>{this.$root.received.unshift(t)},receiveMulti:t=>{this.$root.received.unshift(...Array.from(t).reverse())},revoke:t=>{let e=this.$root.received.findIndex(e=>e.id===t.id);-1!==e&&this.$root.received.splice(e,1)},config:t=>{this.$root.config=t,console.log(`%c Cloud Clipboard ${t.version} by TransparentLC %c https://github.com/TransparentLC/cloud-clipboard `,"color:#fff;background-color:#1e88e5","color:#fff;background-color:#64b5f6")},connect:t=>{this.$root.device.push(t)},disconnect:t=>{let e=this.$root.device.findIndex(e=>e.id===t.id);-1!==e&&this.$root.device.splice(e,1)},forbidden:()=>{this.authCode="",localStorage.removeItem("auth")}}}},watch:{room(){this.disconnect(),this.connect()}},methods:{connect(){this.websocketConnecting=!0,this.$toast(this.retry?`未能连接到服务器，正在尝试第 ${this.retry} 次重连……`:"正在连接服务器……",{showClose:!1,dismissable:!1,timeout:0}),this.$http.get("server").then(t=>(this.authCode&&localStorage.setItem("auth",this.authCode),new Promise((e,a)=>{const o=new URL(t.data.server);if(o.protocol="https:"===location.protocol?"wss:":"ws:",o.port=location.port,t.data.auth){if(!this.authCode)return void(this.authCodeDialog=!0);o.searchParams.set("auth",this.authCode)}o.searchParams.set("room",this.room);const i=new WebSocket(o);i.onopen=()=>e(i),i.onerror=a}))).then(t=>{this.websocketConnecting=!1,this.retry=0,this.received=[],this.$toast("连接服务器成功"),setInterval(()=>{t.send("")},3e4),t.onclose=()=>{this.failure()},t.onmessage=t=>{try{let e=JSON.parse(t.data);(this.event[e.event]||(()=>{}))(e.data)}catch{}},this.websocket=t}).catch(t=>{this.websocketConnecting=!1,this.failure()})},disconnect(){this.websocketConnecting=!1,this.websocket&&(this.websocket.onclose=()=>{},this.websocket.close(),this.websocket=null),this.$root.device=[]},failure(){this.websocket=null,this.$root.device=[],this.retry++<3?this.connect():this.$toast.error("连接服务器失败，请点击工具栏上的“连接”图标重试",{showClose:!1,dismissable:!1,timeout:0})}},mounted(){this.connect()}},Gt=a("cee4"),Yt=a("a7fe"),Kt=a.n(Yt),Qt=a("9aa5"),Xt=a.n(Qt);a("d4b8");o["a"].config.productionTip=!1,o["a"].use(Kt.a,Gt["a"]),o["a"].directive("linkified",Xt.a),o["a"].filter("prettyFileSize",tt),o["a"].filter("percentage",et),o["a"].filter("formatTimestamp",at),new o["a"]({mixins:[Jt],data(){return{date:new Date,dark:null,config:{version:"",text:{limit:0},file:{expire:0,chunk:0,limit:0}},send:{text:"",files:[]},received:[],device:[]}},router:Bt,vuetify:Ht,render:t=>t(I),watch:{dark(t){this.$vuetify.theme.dark=this.useDark,localStorage.setItem("darkmode",t)}},computed:{useDark:{cache:!1,get(){switch(this.dark){case"enable":return!0;case"disable":return!1;case"time":let t=this.date.getHours();return t>=19||t<7;case"prefer":return matchMedia("(prefers-color-scheme:dark)").matches;default:return!1}}}},mounted(){this.dark=localStorage.getItem("darkmode")||"prefer",this.$vuetify.theme.dark=this.useDark,setInterval(()=>{this.date=new Date,this.$vuetify.theme.dark=this.useDark},1e3)}}).$mount("#app")},9067:function(t,e,a){"use strict";a("a987")},a987:function(t,e,a){}});